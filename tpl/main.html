<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- <meta http-equiv="refresh" content="15"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap 101 Template</title>

  <!-- Bootstrap -->
  <link href="../static/css/bootstrap.min.css" rel="stylesheet">
  <link href="../static/css/style.css" rel="stylesheet">  

</head>
<body>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="../static/js/bootstrap.min.js"></script>

  <script> 
    setInterval(function()
    {
      $.ajax({
        type: "GET",
        url: "/mongo_count",
        // data: "tag=29",
        success: function(arg){
          document.getElementById('resp_count').innerHTML=arg.response_log;
          document.getElementById('http_count').innerHTML=arg.http_diff;
        }
      });
    }, 500);
  </script>

  {% include "mainmenu.html" %}

  <div class="lilpage container">
    <header class="headertext" id="overview">
      <h4>Инструменты запуска отстрела</h4>
      <h5>Default-настройки для этапа0, их можно кастомизировать</h5>
      {% for key in last_config %}
      <li>{{ key }}: {{ last_config[key] }}</li>
      {% end %} 
    </header>
    <div class="row vertical-divider" style="margin-top: 30px">
      <div class="col-xs-9">
        <div class="tabbable tabs-left">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#search" data-toggle="tab">Поиск</a></li>
            <li><a href="#partner" data-toggle="tab">Партнер</a></li>
            <li><a href="#rtb" data-toggle="tab">РТБ</a></li>
            <li><a href="#bsrank" data-toggle="tab">Торги</a></li>
            <li><a href="#metrika" data-toggle="tab">Метрика</a></li>  
            <li><a href="#bigb" data-toggle="tab">БигБ</a></li>
            <li><a href="#turl" data-toggle="tab">Турл</a></li>           
          </ul>
          <div class="tab-content">
            <div class="tab-pane active" id="search">
              {% include "param.html" %}
              <div class="col-lg-2">
                <label type="button" class="btn btn-default"  id="searchShoot"><!-- active -->
                  <span class="glyphicon glyphicon-play-circle" ></span>
                  Запустить
                </label>

              </div> 
            </div>
            <div class="tab-pane" id="partner">
              {% include "param.html" %}
               <div class="col-lg-2">
                <label type="button" class="btn btn-default"  id="partnerShoot"><!-- active -->
                  <span class="glyphicon glyphicon-play-circle" ></span>
                  Запустить
                </label>            
              </div>
            </div>
            <div class="tab-pane" id="rtb">
              {% include "param.html" %}
            </div>
            <div class="tab-pane" id="bsrank">
              {% include "param.html" %}
            </div>
            <div class="tab-pane" id="metrika">
              {% include "param.html" %}
            </div>
            <div class="tab-pane" id="bigb">
              {% include "param.html" %}
            </div>     
            <div class="tab-pane" id="turl">
              {% include "param.html" %}
            </div>           
          </div>
        </div>
      </div>
      {% include "statusmongo.html" %}
    </div>
  </div>

  <script>
    function sendParams(e, role, count, isDebug, isPageCode) {
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: "/run",
            data: { 
              role: role,
              shootCount: count, 
              isDebug: isDebug, 
              isPageCode: isPageCode},
            success: function (data) {
                return false
            }
        });      
    }

    $("#searchShoot").click(function (e) {
      sendParams(e, "yabs", $("#shootCount").val(), $("#isDebug").is(':checked'),  $("#isPageCode").is(':checked'))
        e.preventDefault();
    });
    $("#partnerShoot").click(function (e) {
      sendParams(e, "bs", $("#shootCount").val(), $("#isDebug").is(':checked'),  $("#isPageCode").is(':checked'))
        e.preventDefault();
    });    
  </script>  
</body>
</html>
